var app,scope,updateTime,header=document.getElementsByTagName("header")[0],nav=document.getElementsByTagName("nav")[0],main=document.getElementsByTagName("main")[0],mainBorderTop=parseInt($(main).css("border-top-width").replace("px","")),footer=document.getElementsByTagName("footer")[0],navList=document.getElementById("navlist"),list=nav.getElementsByTagName("li"),listWidth=null,listHeight=null,delta=null,narrow=!1;angular.module("appModule",[]),angular.module("appModule").controller("appController",(function($timeout,$scope){app=this,scope=angular.element($(document.body)).scope(),app.Today=moment().toDate(),app.HealingAndWellnessScrolledOutOfView=!1,app.IsNarrow=!1,app.MenuOn=!1,app.IsModernTheme=!1,app.SectionWidth=document.body.offsetWidth>1048?1048:document.body.offsetWidth-40,app.SectionOffset=0,app.ToggleIsModernTheme=function(){app.IsModernTheme=!app.IsModernTheme,document.getElementById("mainCss").href=app.IsModernTheme?"css/main-modern.css":"css/main.css"},app.CurrentMainHeight="0px",app.CurrentPageHeight="auto",app.ContactGoogleMapCurrentHeight="0px",app.PreviousNarrowMapHeight="0px",app.CurrentTheme,app.Themes={coffee:new ThemeObject({name:"coffee"}),blue:new ThemeObject({name:"blue"}),blueLight:new ThemeObject({name:"blue light",isDisabled:!1}),orange:new ThemeObject({name:"orange",isDisabled:!0})},app.SelectTheme=function(selected_theme){for(var theme in app.Themes)app.Themes[theme].isSelected=!1;app.CurrentTheme=selected_theme,selected_theme.isSelected=!0},app.SelectTheme(app.Themes.blue),app.CurrentFont,app.Fonts={sans:new ThemeObject({name:"sans-serif",isSelected:!1}),serif:new ThemeObject({name:"serif",isSelected:!0})},app.CurrentFontSize,app.FontSizes={normal:new ThemeObject({name:"normal",isSelected:!0}),big:new ThemeObject({name:"big",isSelected:!1}),bigger:new ThemeObject({name:"bigger",isSelected:!1})},app.SelectFontSize=function(selected_font){for(var font in app.FontSizes)app.FontSizes[font].isSelected=!1;app.CurrentFontSize=selected_font,app.CurrentFontSize.isSelected=!0,GetNavElementsWidth()},app.ExpandAllResources=!1,app.ResourceGroups=BaseResourceGroups,app.ToggleAllResources=function(){for(app.ExpandAllResources=!app.ExpandAllResources,i=0;i<app.ResourceGroups.length;i++){var group;app.ResourceGroups[i].isRevealed=app.ExpandAllResources}},app.CurrentLink,app.NavigationLinks={home:new NavigationLinkObject({id:"home",name:"Welcome",position:0,page:"pages/welcome.html"}),services:new NavigationLinkObject({id:"services",name:"Services",position:1,page:"pages/services.html"}),about:new NavigationLinkObject({id:"about",name:"About",position:2,page:"pages/about.html"}),connect:new NavigationLinkObject({id:"connect",name:"Connect",position:3,page:"pages/connect.html",previousIds:["contact"]}),newClient:new NavigationLinkObject({id:"newClient",name:"New clients",position:4,page:"pages/newClient.html",previousId:["intake"]}),resources:new NavigationLinkObject({id:"resources",name:"Resources",position:5,page:"pages/resources.html"})},app.SelectLink=function(selected_link){for(var link in narrow=document.body.offsetWidth-delta<listWidth||document.body.offsetHeight<550,app.NavigationLinks){var target=app.NavigationLinks[link];if(target.isSelected=!1,selected_link==target){var narrowAccomodation=narrow?40:0;console.log(app.SectionWidth),app.SectionOffset=(app.SectionWidth+narrowAccomodation)*-target.position}}selected_link==app.NavigationLinks.connect&&log("select link called"),app.CurrentLink=selected_link,app.CurrentLink.isSelected=!0},app.CheckHashAgainstPageIds=function(hash){for(link in app.NavigationLinks){if(hash==app.NavigationLinks[link].id)return hash;for(previousId in app.NavigationLinks[link].previousIds)if(hash==app.NavigationLinks[link].previousIds[previousId])return app.NavigationLinks[link].id}return null},app.UpdateCheckURL=function(checkHash){if(checkHash=null!=checkHash&&checkHash,null!=getHashValue("/page")){var pageId=app.CheckHashAgainstPageIds(getHashValue("/page"));1==checkHash?null!=pageId?app.SelectLink(app.NavigationLinks[pageId]):app.PushHistory(app.NavigationLinks.home.id):app.SelectLink(app.NavigationLinks[pageId])}else app.PushHistory("home")},app.PushHistory=function(linkId){history.pushState(null,"","#/page="+linkId),app.UpdateCheckURL()}})).filter("orderObjectBy",(function(){return function(items,field,reverse){var filtered=[];return angular.forEach(items,(function(item){filtered.push(item)})),filtered.sort((function(a,b){return a[field]>b[field]?1:-1})),reverse&&filtered.reverse(),filtered}}));var NavigationLinkObject=function(spec){this.id=spec.id,this.name=null==spec.name?"":spec.name,this.position=spec.position,this.isSelected=null!=spec.isSelected&&spec.isSelected,this.isDisabled=null!=spec.isDisabled&&spec.isDisabled,this.previousIds=spec.previousIds,this.page=spec.page},ThemeObject=function(spec){this.name=null==spec.name?"":spec.name,this.position=spec.position,this.isSelected=null!=spec.isSelected&&spec.isSelected,this.isDisabled=null!=spec.isDisabled&&spec.isDisabled},FontObject=function(spec){this.name=null==spec.name?"":spec.name,this.position=spec.position,this.isSelected=null!=spec.isSelected&&spec.isSelected,this.isDisabled=null!=spec.isDisabled&&spec.isDisabled};function UpdateLayout(){narrow=document.body.offsetWidth-delta<listWidth||document.body.offsetHeight<550,app.IsNarrow=narrow;var newHeight=document.body.offsetHeight-header.offsetTop-header.offsetHeight-nav.offsetHeight-footer.offsetHeight+(app.IsNarrow,-20);if(app.SectionWidth=document.body.offsetWidth>1048?1048:document.body.offsetWidth-40,app.CurrentMainHeight!=newHeight+"px"&&(app.IsNarrow?(app.CurrentMainHeight=newHeight+"px",app.PreviousNarrowMapHeight!=newHeight+"px"&&(app.ContactGoogleMapCurrentHeight=parseInt(newHeight)+"px",app.PreviousNarrowMapHeight=app.ContactGoogleMapCurrentHeight,app.NavigationLinks.connect.isSelected)):app.CurrentMainHeight=newHeight+"px"),app.CurrentPageHeight=app.CurrentMainHeight,narrow){var scrollTop=document.getElementsByTagName("wrap")[0].scrollTop;app.HealingAndWellnessScrolledOutOfView=scrollTop>30}scope.$apply()}function GetNavElementsWidth(){if(mainBorderTop=parseInt($(main).css("border-top-width").replace("px","")),list.length>0){for(var width=0,modifier=-1!=navigator.userAgent.indexOf("iPad")?73:0,i=list.length-1;i>=0;i--)width+=list[i].getElementsByTagName("button")[0].offsetWidth+2-modifier;listWidth=width,delta=80,app.UpdateCheckURL(!0),scope.$apply(),updateTime=window.setInterval(UpdateLayout,16),-1==document.getElementsByTagName("html")[0].className.indexOf("loaded")&&(document.getElementsByTagName("html")[0].className=document.getElementsByTagName("html")[0].className+" loaded")}else window.setTimeout(GetNavElementsWidth,100)}$(window).on("hashchange",(function(){app.UpdateCheckURL(!0),scope.$apply()})),window.onpopstate=function(event){event&&event.state&&(window.location=window.location)},document.body.onload=window.setTimeout((function(){GetNavElementsWidth()}),100);